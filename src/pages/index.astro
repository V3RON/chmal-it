---
import BaseLayout from "../layouts/BaseLayout.astro";
import { getCollection } from "astro:content";
import Button from "@/components/ui/Button.astro";
import { Github } from "lucide-astro";
import HeroBackground from "@/components/HeroBackground.astro";
import FeaturedProject from "@/components/FeaturedProject.astro";
import HomeSection from "@/components/HomeSection.astro";
import SectionHeader from "@/components/SectionHeader.astro";
import BlogPostCard from "@/components/BlogPostCard.astro";
import TalkCardPreview from "@/components/TalkCardPreview.astro";

const posts = (await getCollection("blog"))
  .sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf())
  .slice(0, 3);

const talks = (await getCollection("talks"))
  .sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf())
  .slice(0, 3);

const projects = (await getCollection("projects")).filter((p) => p.data.featured);
---

<BaseLayout mainClass="">
  {/* Hero Section */}
  <section class="relative border-b border-border/40 bg-background/50 overflow-hidden">
    <HeroBackground />
    <div class="container relative z-10 grid items-center gap-6 pb-8 pt-6 md:py-24 lg:py-32">
        <div class="flex max-w-[980px] flex-col items-start gap-4">
        <h1 class="text-4xl font-extrabold leading-tight tracking-tighter md:text-6xl lg:text-7xl lg:leading-[1.1] text-gradient">
          Building the tools <br class="hidden sm:inline" />
          I wish I had for React Native.
        </h1>
        <p class="max-w-[750px] text-lg text-muted-foreground sm:text-xl md:text-2xl leading-relaxed">
          A digital garden where I share my journey building developer tools to help create better React Native apps.
        </p>
        </div>
        <div class="flex flex-col sm:flex-row gap-4 mt-2">
        <Button href="/blog" size="lg" class="h-12 px-8 text-base">
            Read journal
        </Button>
        <Button variant="outline" size="lg" href="https://github.com/v3ron" class="h-12 px-8 text-base">
            <Github class="mr-2 h-5 w-5" />
            GitHub
        </Button>
        </div>
    </div>
  </section>

  {/* Latest Posts */}
  <HomeSection>
    <SectionHeader title="Engineering journal" viewAllText="View all entries" viewAllHref="/blog" />
    <div class="mx-auto grid justify-center gap-6 sm:grid-cols-2 lg:grid-cols-3 mt-10">
      {
        posts.map((post) => (
          <BlogPostCard post={post} />
        ))
      }
    </div>
  </HomeSection>

  {/* Projects Bento */}
  <HomeSection class="border-t border-border/40 bg-muted/10">
        <SectionHeader title="Open Source" viewAllText="View all projects" viewAllHref="/projects" class="mb-10" />

        <div class="grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3">
        {
            projects.map((project) => (
            <FeaturedProject project={project} class="bg-background" />
            ))
        }
        </div>
  </HomeSection>

  {/* Talks Section */}
  <HomeSection class="border-t border-border/40">
    <SectionHeader title="Featured Talks" viewAllText="View all talks" viewAllHref="/talks" class="mb-10" />
    <div class="grid justify-center gap-6 sm:grid-cols-2 lg:grid-cols-3">
      {
        talks.map((talk) => (
          <TalkCardPreview talk={talk} />
        ))
      }
    </div>
  </HomeSection>
</BaseLayout>
